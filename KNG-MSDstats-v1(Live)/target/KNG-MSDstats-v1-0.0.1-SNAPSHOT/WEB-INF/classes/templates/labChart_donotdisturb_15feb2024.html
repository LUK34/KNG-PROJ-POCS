<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{corelayout}">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta http-equiv="X-UA-Compatible" content="ie-edge">

<!-- <meta http-equiv="refresh" content="5; url=/login"> -->

<title>Lab Charts</title>

<!-- <script src="http://ajax.google"></script> -->
<style>
	.btn{
		text-align: left;
		padding-left: 16px;
	}
</style>

</head>

<body class="hold-transition  sidebar-mini layout-fixed layout-navbar-fixed layout-footer-fixed">
<div layout:fragment="content">
	
	
		<!-- Content Header (Page header) -->
		<div class="content-header">
			<div class="container-fluid">
				<div class="row mb-2">
					<div class="col-sm-6">
						<h1 class="m-0" th:text="#{Lab_Chart}">Lab Charts</h1>

					</div>
					
					
				
					<!-- /.col -->
					<div class="col-sm-6">
						<ol class="breadcrumb float-sm-right">
							<li class="breadcrumb-item"><a href="#" th:text="#{Home}">Home</a></li>
							<li class="breadcrumb-item active"><a
								href="./labChart" th:text="#{Lab_Chart}">Lab Charts</a></li>
						</ol>
					</div>
					<!-- /.col -->
				</div>
				<!-- /.row -->
			</div>
			<!-- /.container-fluid -->
		</div>
		<!-- /.content-header -->

	
<div th:fragment="labChart">	
	<div class="container-fluid">
		<div class="row">
		    <div class="col-12">
	
	<!--  ---------------------------------------------------- LAB CHART START ------------------------------------------------- -->
		
			<div class="card">  
				<div class="card-header">
				       <h5><b>1. Lab Chart:&nbsp;&nbsp;</b></h5>
				 </div>
				<div class="card-body">
					<form id="labFormBeanChart" th:action="@{/labChart}" class="form-horizontal" th:object=${labFormBean} >
						<span>
		
							<div class="row" style="text-align: center;">
									<div class="col-sm-4"></div>
									<div class="col-sm-4"><p id="labchart-error-message" style="color: red; cursor: pointer;"></p></div>
									<div class="col-sm-4"></div>				
							</div>
							
							
							<div class="row" style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem;">
						            <div style="display: flex; align-items: center;">
						                <span style="margin-right: 0.5rem;">Clinic Name:</span>
						                <select id="labyClinicId" th:field="*{labOid}" >
						                    <option value='0'>All Clinics</option>
					           					 <option th:each="e : ${LabOfficeDateFilter}"
																	th:value="${e.officeId}"
																	th:text="${e.officeName}">
												 </option>
						                </select>
						            </div>
						            <div style="display: flex; align-items: center;">
						                <span style="margin-right: 0.5rem;">From date:</span>
						                <input type="date" id="labySdate" th:field="*{labSdate}" style="margin-right: 1rem;">
						                <span  style="margin-right: 0.5rem;">To date:</span>
						                <input type="date" id="labyEdate" th:field="*{labEdate}" style="margin-right: 1rem;">
						                <button type="submit" class="btn btn-primary"><i class="fas fa-search"></i></button>
						            </div>
			       			 </div>
		       			 
						</span>
					</form>
				</div>
			</div> 
			
			
			<div class="row">
			<div class="col-md-12">
				 <div class="row">
			<!-- ------------------------------------------- SAMPLE COLLECTION  Chart called here START ------------------------------------------ -->
				 	<div class="col-md-4">
						 	<div class="card card-primary">
								 
									<div class="card-header border-transparent">
										<h3 class="card-title" th:text="#{Sample_Collection_by_Branches}">Sample Collection by Branches</h3>

										<div class="card-tools">
											<button type="button" class="btn btn-tool"
												data-card-widget="collapse">
												<i class="fas fa-minus"></i>
											</button>
											<button type="button" class="btn btn-tool"
												data-card-widget="remove">
												<i class="fas fa-times"></i>
											</button>
										</div>
									</div>
									
									<div class="card-body">
										<div class="chart">
											<input type="hidden" th:id="sampleCollectChartLabels" th:value="${sampleCollectChart.labscoLabel}" /> 
											<input type="hidden" th:id="sampleCollectChartData"   th:value="${sampleCollectChart.labscoData}" />
											<canvas id="sampleCollectChart" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;"></canvas>
										</div>
									</div>
									
							</div>
					</div>
			<!-- ------------------------------------------- SAMPLE COLLECTION  Chart called here END ------------------------------------------ -->
			
			<!-- ------------------------------------------- ACCESSION/AKNWLDG Chart called here START ------------------------------------------ -->
					
					 <div class="col-md-4">
						 <div class="card card-primary">
								 
									<div class="card-header border-transparent">
										<h3 class="card-title" th:text="#{Accession_by_Branches}">Accession by Branches</h3>

										<div class="card-tools">
											<button type="button" class="btn btn-tool"
												data-card-widget="collapse">
												<i class="fas fa-minus"></i>
											</button>
											<button type="button" class="btn btn-tool"
												data-card-widget="remove">
												<i class="fas fa-times"></i>
											</button>
										</div>
									</div>
									
									<div class="card-body">
										<div class="chart">
											<input type="hidden" th:id="accessAcknwldgChartLabels" th:value="${accessAcknwldgChart.labaaoLabel}" /> 
											<input type="hidden" th:id="accessAcknwldgChartData"   th:value="${accessAcknwldgChart.labaaoData}" />
											<canvas id="accessAcknwldgChart" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;"></canvas>
										</div>
									</div>
									
							</div>
					 </div>
				<!-- ------------------------------------------- ACCESSION/AKNWLDG Chart called here END ------------------------------------------ -->
				
					
					<div class="col-md-4">
					</div>
					
					
				 </div>
			</div>
		</div>
			
			
			
	<!--  ---------------------------------------------------- LAB CHART END ------------------------------------------------- -->
		    
		    
		    
		    
		    
		    
		    
		    </div>
		</div>
	</div>
</div>

</div>




<th:block layout:fragment="script">
	
		<script src="./admin/plugins/chart.js/chart.min_new.js"></script>
		<script src="./admin/plugins/chart.js/chartjs-plugin-datalabels@2.0.0-rc"></script>
		<script src="./admin/custom/labjs/lc.js" type="module"></script>
<script>
		
//-- ----------------------------------------------------- SAMPLE COLLECTION CHART JS LOGIC START ----------------------------------------------------- -->	

			//var sampleCollectChartLabels = $("#sampleCollectChartLabels").val();
			var sampleCollectChartLabels = document.getElementById("sampleCollectChartLabels").value;
   				sampleCollectChartLabels = sampleCollectChartLabels.replace("[","").replace("]","").replaceAll("-MultiSpeciality","").split(",");
			//var sampleCollectChartData = $("#sampleCollectChartData").val().trim();
			var sampleCollectChartData = document.getElementById("sampleCollectChartData").value.trim();
				sampleCollectChartData = sampleCollectChartData.replace("[","").replace("]","").split(",");
			var sampleCollectChartDataToDisplay = 
			{		/* Object and array of Objects applied here */
					labels:sampleCollectChartLabels,
					datasets: [{
								  data:sampleCollectChartData ,// [30, 17, 15, 19, 20],
		      					  backgroundColor: ['#4b77a9', '#B27200', '#00c0ef','#5f255f','#d21243'],
		      					  label: 'Sample Collect',
      					 	   }]
			}
			var sampleCollectChartOptions=
			{		/* Nested objects logic applied here */
				legend: {display: false},
				plugins:{
							  legend: {display: false},
		  					  labels:
		  					  {
									render:'value',
									fontColor:'white',
									fontStyle:'bolder',
							  },
			 				  datalabels:
			 				  {
		        					labels:{ value:{ color:'white' } }
		        			  }		
						},
				scales: {
							 /* Array of Objects aplied here */
	  						  yAxes: [{    ticks: { beginAtZero:true }	}]
						},
				onClick: function(event,element)
						{
							if(element.length>0)
							{
								let str=parseInt(element[0].index);
								let num=str+1;
								var url='./sampleCollectInfoWithOffice?OfficeName='+sampleCollectChartCreator.data.labels[element[0].index].trim();
								openWindow(url);
							}
						}
			
			 }
			 
			 var sampleCollectChartCreator = new Chart(//sampleCollectChartCanvas,
			 document.getElementById('sampleCollectChart'), 
			 {
						  type: 'bar',
						  data: sampleCollectChartDataToDisplay,
						  options: sampleCollectChartOptions,
						  plugins:[ChartDataLabels]
			 });
			

// ----------------------------------------------------- SAMPLE COLLECTION CHART JS LOGIC START ----------------------------------------------------- -->	


// ----------------------------------------------------- ACCESSION ACKNWLDG CHART JS LOGIC START ----------------------------------------------------- -->	

			//var accessAcknwldgChartLabels = $("#accessAcknwldgChartLabels").val();
			var accessAcknwldgChartLabels= document.getElementById("accessAcknwldgChartLabels").value;
   				accessAcknwldgChartLabels = accessAcknwldgChartLabels.replace("[","").replace("]","").replaceAll("-MultiSpeciality","").split(",");
			//var accessAcknwldgChartData = $("#accessAcknwldgChartData").val().trim();
			var accessAcknwldgChartData= document.getElementById("accessAcknwldgChartData").value.trim();
				accessAcknwldgChartData = accessAcknwldgChartData.replace("[","").replace("]","").split(",");
			var accessAcknwldgChartDataToDisplay = 
			{		/* Object and array of Objects applied here */
					labels:accessAcknwldgChartLabels,
					datasets: [{
								  data:accessAcknwldgChartData ,// [30, 17, 15, 19, 20],
		      					  backgroundColor: ['#4b77a9', '#B27200', '#00c0ef','#5f255f','#d21243'],
		      					  label: 'Accession',
      					 	   }]
			}
			var accessAcknwldgChartOptions=
			{		/* Nested objects logic applied here */
				legend: {display: false},
				plugins:{
							  legend: {display: false},
		  					  labels:
		  					  {
									render:'value',
									fontColor:'white',
									fontStyle:'bolder',
							  },
			 				  datalabels:
			 				  {
		        					labels:{ value:{ color:'white' } }
		        			  }		
						},
				scales: {
							 /* Array of Objects aplied here */
	  						  yAxes: [{    ticks: { beginAtZero:true }	}]
						},
				onClick: function(event,element)
						{
							if(element.length>0)
							{
								let str=parseInt(element[0].index);
								let num=str+1;
								var url='./accessAcknwldgInfoWithOffice?OfficeName='+accessAcknwldgChartCreator.data.labels[element[0].index].trim();
								openWindow(url);
							}
						}
			
			 }
			 
			 var accessAcknwldgChartCreator = new Chart(//sampleCollectChartCanvas,
			 document.getElementById('accessAcknwldgChart'), 
			 {
						  type: 'bar',
						  data: accessAcknwldgChartDataToDisplay,
						  options: accessAcknwldgChartOptions,
						  plugins:[ChartDataLabels]
			 });
			 
			 function openWindow(url)
	 		{
				var popupwindow=window.open(url,'','location=no,width=1500,height=900');
				popupwindow.moveTo((screen.width/2)-700,(screen.height/2)-450);
		
	 		}
			
	</script>
<!-- ----------------------------------------------------- ACCESSION ACKNWLDG CHART JS LOGIC END ----------------------------------------------------- -->	
	

	
			

</th:block>
</body>


</html>